import tensorflow as tf
import tensorflow_hub as hub
import matplotlib.pyplot as plt
from google.colab import files
import os
print("Upload CONTENT image (photo)")
content_files = files.upload()
content_name = list(content_files.keys())[0]

print("Upload STYLE image (artwork)")
style_files = files.upload()
style_name = list(style_files.keys())[0]
def load_image(image_path):
    img = tf.io.read_file(image_path)
    img = tf.image.decode_image(img, channels=3)
    img = tf.image.convert_image_dtype(img, tf.float32)
    img = tf.image.resize(img, (384, 384))
    img = img[tf.newaxis, :]
    return img
content_image = load_image(content_name)
style_image = load_image(style_name)
model = hub.load(
    "https://tfhub.dev/google/magenta/arbitrary-image-stylization-v1-256/2"
)
stylized_image = model(content_image, style_image)[0]
plt.figure(figsize=(15, 5))

plt.subplot(1, 3, 1)
plt.imshow(content_image[0])
plt.title("Content Image")
plt.axis("off")

plt.subplot(1, 3, 2)
plt.imshow(style_image[0])
plt.title("Style Image")
plt.axis("off")

plt.subplot(1, 3, 3)
plt.imshow(stylized_image[0])
plt.title("Stylized Output")
plt.axis("off")

plt.show()
